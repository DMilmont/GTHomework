---
title: "Week 5 Homework"
output: pdf_document
---

#loading packages and setting seed for homework
```{r, message=FALSE, warning=FALSE}
library('tidyverse')
library('glmnet')
library('GGally')
library('MASS')


#Set seed for reproducibility
set.seed(156)

```

#Question 1:
Using the crime data set from Homework 3, build a regression model using:
1. Stepwise regression
2. Lasso
3. Elastic net
For Parts 2 and 3, remember to scale the data first – otherwise, the regression coefficients will be on
different scales and the constraint won’t have the desired effect.
For Parts 2 and 3, use the glmnet function in R. 

```{r}
#Crime data file 
crimeData <- read.table("http://www.statsci.org/data/general/uscrime.txt", header = TRUE)

#serparting out dataset
x <- as.matrix(crimeData[,1:15])
y <- as.double(as.matrix(crimeData[,16]))

#creating model 
glmMod <- glmnet(x,y,family='gaussian', standardize = TRUE)
glmMod.cv <- cv.glmnet(x,y,family='gaussian', standardize = TRUE)

plot(glmMod)
plot(glmMod.cv)

glm.pred <- predict(glmMod,newx=x)
mte=apply((tpred-hiv.test$y)^2,2,mean)

#creating MSE
mean((y - glm.pred)^2)


```

